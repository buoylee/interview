# RDB

快照(snapshot)形式, 直接把内存中的数据保存到一个dump.rdb文件中

Redis会fork一个子进程，子进程将数据写到磁盘上一个临时RDB文件中。当子进程完成写临时文件后，将原来的RDB替换掉，这样的好处是可以copy-on-write.

适合用于备份, 如果你需要尽量避免在服务器故障时丢失数据，那么RDB不合适.

# AOF

每一个写命令都通过write函数追加到appendonly.aof中

```
appendfsync yes   
appendfsync always     #每次有数据修改发生时都会写入AOF文件, 然后在reply给client.
appendfsync everysec   #每秒钟同步一次，该策略为AOF的缺省策略。
```



# 开启策略

定时生成RDB快照非常便于进行数据库备份，并且RDB恢复数据集的速度也要比AOF恢复的速度快。

redis支持同时开启RDB和AOF，系统重启后，redis会优先使用AOF来恢复数据，这样丢失的数据会最少。