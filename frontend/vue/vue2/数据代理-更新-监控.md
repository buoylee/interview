# 前置

看 defineproperty.md 文件





# 概述



直接替换整个 list[0], 导致vue没有监控到数据变化.

定义的 vue data{} 最终 放到 vm._data中.

<img src="/Users/buoy/Development/gitrepo/interview/frontend/vue/vue2/assets/image-20251010153459459.png" alt="image-20251010153459459"  />



## 创建过程

原始 data{} -> 加工(具有响应式) -> 放入 _data



## 响应式 setter(实现对对象/属性的监视)

原理, 当监控到 属性变化, 生成虚拟dom, 对比真实dom, 变化就update.





## 大致原理

### 错误版本

![image-20251010155055984](/Users/buoy/Development/gitrepo/interview/frontend/vue/vue2/assets/image-20251010155055984.png)

这种写法会导致栈溢出.  Return 时, data.name 又会触发 Object.defineProperty.



## 正确, 但不够完善版本

![image-20251010155241717](/Users/buoy/Development/gitrepo/interview/frontend/vue/vue2/assets/image-20251010155241717.png)



# vue.set

**限制, 不能给"vm本身/第一层对象"加, 只能给"响应式对象(第2层开始)"加.**

如果要添加不存在的属性, 如果直接给 vm._data.xxx = yyy, 将会是一个普通的属性, 而不是vue的响应式属性.

所以需要 api 来实现, 

Vue.set(); 

vm.$set()

例: `vm.$set(vm._data.student,'sex', '女')`, `vm.$set(vm.student,'sex', '女')`





## 检测 数组 原理

直接修改arr是无效的. 因为不是通过set/get来监视的.

`vm._data.student.hobby［e］='学习'` 



只有通过 js arr apis / set 来操作才能检测到数据改变(响应式).

`vm._data.student.hobby.push('学习')`

`vm.$set(vm._data.student.hobby, 1, '打台球')`





